<!DOCTYPE html>
<html>
<head>
      <!-- link to style sheet-->
<link rel="stylesheet" type="text/css" href="asg4.css">

 <!-- Include socket.io client API from cdn //-->
<script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>

<script>
      /////////////////////// SOCKET_IO  ///////////////
      // function that sends messages to server: message
	function sendToServer(messageType, message) {
  		try {
                  // if were not connected to a socket, connect to it 
    			if (!connectedSocket) createSocket();
                  //send the server the message 
    			connectedSocket.emit(messageType, message); // send msg to server
  		} catch (err) {
                  // if ending message didn't work then display error to user
    			alert("System error 987: " + err + " contact us, or try again later");
  		}
	}
      // sets value to null to begin with
      var connectedSocket = null;
      //function that connects us to a socket 
      function createSocket() {
            try {
                  //connect to socket on the port 8081
                  connectedSocket = io(window.location.hostname+":8081");

                  /// WE SHOULD SET CONNECTED SOCKET TO TRUE OR SOMETHING RIGHT?
            } catch (err) {
                  // if theres an error display message to user
                  alert('connectedSocket create error, contact us');
                  // set value to null
                  connectedSocket = null;
                  return;
            }
            //on server message received then do...
            connectedSocket.on("general-msg", function (message) {
			// if message we received is activeList then we...
                  if(message.activeList) {
                        // update the idles and active games page 
                        fillActives(message.activeList);
                        fillIdles(message.idleList);
                  }
        	});

            connectedSocket.on("UPDATED-USER-LIST-AND-STATUS", function (message) {
                  // update the idles and active games page 
                  fillActives(message.activeList);
                  fillIdles(message.idleList);
        	});
            
            // when the user is connected to an opponent
            var whoAmI;
            connectedSocket.on("PLAY", function (message) {
			//alert(message.x_player + " is x\n" + message.o_player + " is o");
                  let opponent;

                  if(whoAmI == 'x') {
                        opponent = message.o_player;
                  } else {
                        opponent = message.x_player;
                  }
                  
                  document.getElementById("x_screen").innerHTML = "X: " + message.x_player;
                  document.getElementById("o_screen").innerHTML = "O: " + message.o_player;
                  inGame = true;
                  //GAME IS STARTED
        	});

            // if user log-in fails 
            connectedSocket.on("LOGIN-FAIL", function (message) {
                  // tell user it failed 
			alert(message.message);
                  //display error message on screen 
                  document.getElementById("error_msg").style.visibility ='visible'
                  document.getElementById("error_msg").innerHTML = message.message;
                  
        	});

            // if log-in is good then
            connectedSocket.on("LOGIN-OK", function (message) {
                  // display message to user and update viewport 
                  //alert("MADE IT");
                  document.getElementById("error_msg").style.visibility ='hidden'
                  document.getElementById('main_box').style.visibility = 'visible';
                  document.getElementById('Log_in_screen').style.visibility = 'hidden';
                  fillActives(message.activeList);
                  fillIdles(message.idleList);
        	});

            connectedSocket.on("MOVE", function (message) {
                  console.log('getting  message now:')
                  Take_turn(message.move_placement)
                 // document.getElementsByName(message.move_placement)[0].click();

                  // what is message supposed to be sending???
                  //i think this is looping in on itself 
                  //doesntwork for some reason
        	});
      }

      let Intervalid; //var we use to refresh idles and active games 

      // function that we call to update players and idles 
      function update_players(){
            Intervalid ??= setInterval(Update_players, 1000);
      }
      // function that sends command to server to update all users idle and active games
      function Update_players(){
           connectedSocket.emit("UPDATE");
      }

      //set up var
      var screen_name = "";
      // function we call when user wants to log out
      function logout() {
            inGame = false;
            // send server screen name that wants to log out 
            connectedSocket.emit("TO-SERVER LOGOUT", screen_name);
            // set connected socket status to null
            connectedSocket = null;
            // hides the main display and show the login screen again 
            document.getElementById("main_box").style.visibility = 'hidden';
            document.getElementById('Log_in_screen').style.visibility = 'visible'
      }
      // function that opens help menu
      function open_help_menu(){
            document.getElementById("Help_menu").style.visibility = 'visible'
      }
       // function that closes help menu
      function close_help_menu(){
            document.getElementById("Help_menu").style.visibility = 'hidden'
      }

      var inGame = false;
      function do_a_move(where) {
            if(inGame) {
                  sendToServer("MOVE", {'screen_name': screen_name, 'move_placement': where});
            } else {
                  alert("JOIN A GAME");
            }
      }

      //////////////////////////// DATA BASE STUFF ///////////////////////////
      // function we use to add things to the mysql database
      function addToDB() {
            // get user sent screen name
            screen_name = document.getElementById('Screenname').value;
            // if its null reject it 
            if (screen_name == '') {
                  document.getElementById("error_msg").style.visibility ='visible'
                  document.getElementById("error_msg").innerHTML = "name can not be null"
                  return
            } 
            // connect to server if we need to 
            if (!connectedSocket) createSocket();
            // send request to server 
            sendToServer("TO-SERVER LOGIN", screen_name);
      }

      // show X or O selection and lets user pick one of the two
      function newGameButton() {
            //make the pop up come up
            // select x or o
            document.getElementById('x_or_o').style.visibility = 'visible';
      }

      // after user makes a choice: send info to server 
      function makeGame(choice) {
            whoAmI = choice;
            //makes server call with screen name and choice
            connectedSocket.emit("NEW-GAME", {'screen_name' : screen_name, 'choice_of_X_or_O': choice});
            inGame = true;
      }
      
      // function attached to join game button that use hits to join another users game
      function join_game(button){
            // gets opponents name and changes the button id for use later 
            ops_name = (button.id).replace("join_", "");
            //  send info to server with object 
            sendToServer('JOIN', {'screen_name' : screen_name, 'opponent' : ops_name});
      }

      // use TBD!
      function leave_game(button){
            sendToServer('EXIT', button);
      }
      // function that we call to fill current games
      function fillActives(givenHTML) {
            document.getElementById("actives").innerHTML = givenHTML;
      }
        // function that we call to fill idle players
      function fillIdles(givenHTML) {
            document.getElementById("idle").innerHTML = givenHTML;
      }

      /////////////////////Game board actions//////////////////////////
      // function that we call to show game table 
      function toggle_game_div(button) {
            if(document.getElementById('game_window').style.display == 'none') {
                  document.getElementById('game_window').style.display = 'block';
            } else {
                  document.getElementById('game_window').style.display = 'none';    
            }
      }

      // declare variables to use later 
      let isXTurn = true; 
      // values we use to determent if a block in the game is an x or an o
      let x_num = 2;
      let o_num = 1;
      // move counter
      var move_count  = 0;
      // function we call whenever we want to take a turn
      // function takes in a button since the button to move is the game square itself
      
      function take_turn_setup(button, number){
            do_a_move(number);
            Take_turn(button, number)


      }
      //removed button 
      function Take_turn(button,number){
            

       const gameSquare = document.getElementsByName(number)[0];
     
      //testing block
       //const gameSquare = button.parentElement;  ////here

       ////////////////////
        // Create a new image element
       const newImage = document.createElement('img');
       newImage.style.maxWidth = '100%';
       newImage.style.maxHeight = '100%'; 
       newImage.style.display = 'flex'; 
       newImage.style.objectFit = 'fill';
       
       console.log("im the problem its me")
      

        // if its x's turn, then the next click will be an X
        if (isXTurn) {
            newImage.src = 'X.png'; 
            newImage.alt = 'X';
            // sets the area where the button is, that spots id to a number we relate to X
            // that being an even number which we can use later for game logic


            //button.parentElement.id = x_num; ///////////////////////////////////here
            document.getElementsByName(number)[0].id= x_num


            // changes the game board header to display who's turn it is 
            document.getElementById("whoTurn").innerHTML = "O's Turn";
        } else {
            // if its O's turn then we do the same thing but with the o's
            newImage.src = 'O.webp'; 
            newImage.alt = 'O';
            // here we instead set the id of the buttons position to an odd number
            // we relate odd numbers to O's moves and even for X's moves


            //button.parentElement.id = o_num;/////////////////////here
            document.getElementsByName(number)[0].id= o_num
            document.getElementById("whoTurn").innerHTML = "X's Turn";
        }
        // removes the button from the game 
        //document.getElementsByName(number)[0].button.remove(); ////////////here
        // adds the image to the spot on the board 



        //gameSquare.appendChild(newImage);
        button.remove();
        document.getElementsByName(number)[0].appendChild(newImage);


        // increases the numbers for X and O since were updating ID's and ID's have to be unique
        x_num += 2;
        o_num += 2;
        // change it to O's turn
        isXTurn = !isXTurn;
        // increases move counter 
        move_count ++
            
        // if were on move 4 or grater, then we can start checking the board state 
        if (move_count >= 4){
            Game_status_check()
        }
      }

      // declares vars to use later that we need to be global or initialized 

      // a var for each win line  
      let ABC = true
      let DEF = true
      let GHI = true

      let ADG = true
      let BEH = true
      let CFI = true

      let AEI =  true
      let CEG = true 

      // var for each box 
      let A_val 
      let B_val 
      let C_val

      let D_val 
      let E_val 
      let F_val

      let G_val 
      let H_val 
      let I_val 

      // function that runs game logic and checks current status of the game 
      function Game_status_check(){
            //gets values for each box and sets to a var
            const A = document.getElementsByName('1')[0];
            const B = document.getElementsByName('2')[0];
            const C = document.getElementsByName('3')[0];

            const D = document.getElementsByName('4')[0];
            const E = document.getElementsByName('5')[0];
            const F = document.getElementsByName('6')[0];

            const G = document.getElementsByName('7')[0];
            const H = document.getElementsByName('8')[0];
            const I = document.getElementsByName('9')[0];
            
            // sets some variables we declared earlier and sees if there X's in the box or O's
            // we take the ID of each box, and preform MOD 2 on each.
            // this will always result in a 1 (O's) or 0 (1) and as disused earlier 
            // even is X's and odds are O's
            A_val =  (parseInt(A.id) % 2)
            B_val =  (parseInt(B.id) % 2)
            C_val =  (parseInt(C.id) % 2)

            D_val =  (parseInt(D.id) % 2)
            E_val =  (parseInt(E.id) % 2)
            F_val =  (parseInt(F.id) % 2)

            G_val =  (parseInt(G.id) % 2)
            H_val =  (parseInt(H.id) % 2)
            I_val =  (parseInt(I.id) % 2)

            // checks each value to see if its been defined yet, aka if the box has a move made in it 
            // yet
            const A_defined = !(isNaN(A_val));
            const B_defined = !(isNaN(B_val));
            const C_defined = !(isNaN(C_val));

            const D_defined = !(isNaN(D_val));
            const E_defined = !(isNaN(E_val));
            const F_defined = !(isNaN(F_val));

            const G_defined = !(isNaN(G_val));
            const H_defined = !(isNaN(H_val));
            const I_defined = !(isNaN(I_val));

            ////// DRAW DETECTION ////////////////////////////////

            /* How the draw detection works in this program is essential 
            sudoku. essential for each line a win could be made, we check to see
            if its possible for a win to happen, say we look at the top 3 boxes across 
            those boxes are labeled A B and C. 

            We check Box A and be to see if there both defined if so we see if there the same value
            if there not defined we ignore it, but if they are and the two values are different we say
            that up line to win across is no longer able to be won in or "dead".

            we do the same for A and C then B and C and if there all alive and able to be won within 
            then we continue as normal. this logic is repeated for each line across, down and diagonal
            if any of them are declared "dead" then we know that is not a way either player can win within

            draw detection is also extended to function win_on_last_move. 
            */
            
            // across 
            if ((A_defined && B_defined) && A_val  != B_val ) ABC = false 
            if ((A_defined && C_defined) && A_val  != C_val ) ABC = false
            if ((B_defined && C_defined) && B_val  != C_val ) ABC = false
            // uncomment log messages on front end to see how this sort of thing works
            //console.log("ABC:")
            //console.log(ABC)
            if ((E_defined && D_defined) && E_val  != D_val ) DEF = false 
            if ((E_defined && F_defined) && E_val  != F_val ) DEF = false
            if ((D_defined && F_defined) && D_val  != F_val ) DEF = false
            //console.log("DEF:")
            //console.log(DEF)
            if ((G_defined && H_defined) && G_val  != H_val ) GHI = false 
            if ((G_defined && I_defined) && G_val  != I_val ) GHI = false
            if ((H_defined && I_defined) && H_val  != I_val ) GHI = false
            //console.log("GHI:")
            //console.log(GHI)

            //DOWN
            if ((A_defined && D_defined) && A_val  != D_val ) ADG = false 
            if ((A_defined && G_defined) && A_val  != G_val ) ADG = false
            if ((D_defined && G_defined) && D_val  != G_val ) ADG = false
            //console.log("ADG:")
            //console.log(ADG)
            if ((B_defined && E_defined) && B_val  != E_val ) BEH = false 
            if ((B_defined && H_defined) && B_val  != H_val ) BEH = false
            if ((E_defined && H_defined) && E_val  != H_val ) BEH = false
            //console.log("BEH:")
            //console.log(BEH)
            if ((C_defined && F_defined) && C_val  != F_val ) CFI = false 
            if ((C_defined && I_defined) && C_val  != I_val ) CFI = false
            if ((F_defined && I_defined) && F_val  != I_val ) CFI = false
            //console.log("CFI:")
            //console.log(CFI)

            //diagonal 
            if ((A_defined && E_defined) && A_val  != E_val ) AEI = false 
            if ((A_defined && I_defined) && A_val  != I_val ) AEI = false
            if ((E_defined && I_defined) && E_val  != I_val ) AEI = false
            //console.log("AEI:")
            //console.log(CEG)  
            if ((C_defined && E_defined) && C_val  != E_val ) CEG = false 
            if ((C_defined && G_defined) && C_val  != G_val ) CEG = false
            if ((E_defined && G_defined) && E_val  != G_val ) CEG = false

            // an array of all lines of winning 
            const conditions = [ABC,DEF,GHI,ADG,BEH,CFI,AEI,CEG];

            // sets up counter and also resets it after each function call
            let trueCount = 0;
            // for the amount of lines of winning, loop
            for (let i = 0; i < conditions.length; i++) {
                  // if the line of winning is "dead" add to counter
                  if (!conditions[i]) {
                        trueCount++;
                  }
            }
            // if there is 2 or less avenues of winning and its past turn 6 and 
            // there is no way for X to win on the last move the game is a draw 
            if (trueCount >= 7 && move_count > 6  && !win_on_last_move()){
                  draw()
            }

            // this one can be removed maybe
            // keep this in its the old draw method
            ///testing block 1 
            /*
            // catches error when last move results in a win, 
            if (!ABC && !DEF && !GHI && !ADG && !BEH && !CFI &&!AEI && !CEG ){
                  console.log("ITS A DRAWWW")
                  draw();
            }*/

            ///////////GAME LOGIC////////////////////
            // here we check to see if there is a win detected
            // first we see if the avenue of play is "dead" or not
            // if it is we don't have to see if there a win or not since we know there cannot one

            // so, if line of play ABC is not "dead"
            // across
            if (ABC){
                  // if box A, B, and C all have the same value then we know theres win
                  if (( B_val == A_val) && (C_val == A_val  )) {
                        // if A is an even number then X has won
                        if(A_val  == 0){X_wins();}
                        // if A is an odd number then 0's have won
                        else{ O_wins()}}
            
                  }
            // this logic is repeated for each avenue of winning 
            if(DEF){ 
                  if (( E_val == D_val) && (F_val == D_val )){
                        if(D_val == 0){ X_wins()}
                        else{O_wins()}}
            }

            if(GHI){
                  if (( H_val  == G_val  ) && (I_val == G_val )){
                        if(G_val == 0){X_wins()}
                        else{O_wins()}}      
            }
            //down
            if(ADG){
                  if (( D_val == A_val ) && (G_val  == A_val  )){
                        if(A_val == 0){ X_wins()}
                        else{ O_wins()}}
            }
            if (BEH){
                  if (( E_val == B_val ) && (H_val  == B_val )){
                        if(B_val == 0){X_wins()}
                        else{O_wins()} }
            } 
            if(CFI){
                  if (( F_val  == C_val ) && (I_val == C_val )){
                        if(C_val == 0){X_wins()}
                        else{O_wins()}}
            } 
            // diagonal
            if (AEI){
                  if (( E_val == A_val ) && (I_val == A_val)){
                        if(A_val == 0){X_wins()}
                        else{O_wins()}}
            }
            if (CEG){
                  if (( E_val  == C_val ) && (G_val  == C_val )){
                        if(C_val == 0){X_wins()}
                        else{O_wins()}}
            } 
      }
      // function used for more draw detection to handle edge case of X
      // being able to win the game on the last move
      function win_on_last_move(){ 
            // here we check to see if each value is null
            // if it is we set its value to zero (AKA an X)
            A_val = A_val ?? 0; // If A_val is undefined or null, use 0
            B_val = B_val ?? 0;
            C_val = C_val ?? 0;

            D_val = D_val ?? 0;
            E_val = E_val ?? 0;
            F_val = F_val ?? 0;

            G_val = G_val ?? 0;
            H_val = H_val ?? 0;
            I_val = I_val ?? 0;

            /* then we see if the values in the win line are all x's
            this is to find the last few open boxes and we assume that 
            there all x's. this gets around there not being enough 
            win lanes open 
            while this function is only called on the last few terns 
            it checks to see if x has any way to win in the last few turns
            this issue arises from the game logic/ draw detection mentioned
            before*/

            // if all lines in a row have the possibility to be X's then we return true
            // continuing the game
            if (A_val + B_val + C_val == 0){return true}
            if (D_val + E_val + F_val == 0){return true}
            if (G_val + H_val + I_val == 0){return true}
            if (A_val + D_val + G_val == 0){return true}
            if (B_val + E_val + H_val == 0){return true}
            if (C_val + F_val + I_val == 0){return true}
            if (A_val + E_val + I_val == 0){return true}
            if (C_val + E_val + G_val == 0){return true}
            // if theres no way x can win, then we return false, ending the game
            return false
      }
      // function that hides result menu 
      function hideResultMenu() {
             document.getElementById("result_menu").style.display = "none";
      }
      
      // function that lets the user look at the game table after game results are posted
      function post_game_peek(){
            // removes the result menu content for a moment
            document.getElementById("result_menu-content").style.display = "none";
            // removes dark gray background
            document.getElementById("result_menu").style.backgroundColor = "rgba(0, 0, 0, 0)";

            // sets a timer to show game result menu again 
            setTimeout(function() {
              // sows game menu again 
            document.getElementById("result_menu-content").style.display = "flex"
            // brings back the dark gray background
            document.getElementById("result_menu").style.backgroundColor = "rgba(0, 0, 0, .5)";
            }, 2000); // Delay of 2000 milliseconds (2 seconds)
      }
            // function that disables all game buttons. this is called after the results of the game 
            // results are shown  
      function disable_game_table(){
            // for each game button 
            document.querySelectorAll('.game_squares button').forEach(elem => {
                  // disable that button 
                  elem.disabled = true;
            });
      }
            // same thing as disable_game_buttons but turns them back on 
      function enable_game_table(){
            document.querySelectorAll('.game_squares button').forEach(elem => {
            elem.disabled = false;
            });
      }
      // function that displays win message for X player winning 
      function X_wins(){
             
            // sets consts to elements we use for result menu
            const rmc = document.getElementById("result_menu-content");
            const result_menu = document.getElementById("result_menu");
            // display result menu
            result_menu.style.display = 'flex'; 
            rmc.innerHTML = ''// resets everything so last result screen does not show in new game
            // creates header for win screen
            const win_msg = document.createElement('h1');
            // creates message with images and words all fancy
            win_msg.innerHTML = "<img src='X.png' style='height: 100px; vertical-align: middle;" +
                                    "margin-right: 50px;'>" +
                                    "X WINS!!!!" +
                                    "<img src='X.png' style='height: 100px; vertical-align: middle;"+
                                    "margin-left: 50px;'>";

            // makes a button to close the result menu and make it look nice
            const close_button = document.createElement('button');
            close_button.id = 'Result_close_button';
            close_button.innerHTML = "Close";
            close_button.style.width = "500px"
            close_button.style.height = "75px"
            // give the button the functionality to hide the results
            close_button.onclick = hideResultMenu;
            close_button.style.display = 'flex';
            close_button.style.marginLeft = '25px'

            // create button that lets user look at game results
            const view_game_table = document.createElement('button');
            view_game_table.id = 'Result_close_button';
            // give the button functionality 
            view_game_table.onclick = post_game_peek
            view_game_table.innerHTML = "View game board ";
            // append the win message to the result menu
            rmc.appendChild(win_msg);
            // attach the buttons to the win message 
            win_msg.appendChild(close_button);
            win_msg.appendChild(view_game_table)
            // disable the buttons from the table 
            disable_game_table()
      }

      // same deal with the O results, only this time the content is regarding the O win results 
      function O_wins(){
            const rmc = document.getElementById("result_menu-content");
            const result_menu = document.getElementById("result_menu");
            result_menu.style.display = 'flex'; 
            rmc.innerHTML = '' // resets everything so last result screen does not show in new game

            const win_msg = document.createElement('h1');
            win_msg.innerHTML = "<img src='O.webp' style='height: 100px; vertical-align: middle;" +
                                    "margin-right: 50px;'>" +
                                    "O WINS!!!!" +
                                    "<img src='O.webp' style='height: 100px; vertical-align: middle;"+
                                    "margin-left: 50px;'>";
            
            const close_button = document.createElement('button');
            close_button.id = 'Result_close_button';
            close_button.innerHTML = "Close";
            close_button.style.width = "500px"
            close_button.style.height = "75px"
            close_button.onclick = hideResultMenu;
            close_button.style.display = 'flex';
            close_button.style.marginLeft = '25px'

            const view_game_table = document.createElement('button');
            view_game_table.id = 'Result_close_button';
            view_game_table.onclick = post_game_peek
            view_game_table.innerHTML = "View game board ";

            rmc.appendChild(win_msg);
            win_msg.appendChild(close_button);
            win_msg.appendChild(view_game_table)

            disable_game_table()
      }
      // same deal with the X and O win screen but this time it says draw and shows both the x and the o
      function draw(){
            const rmc = document.getElementById("result_menu-content");
            const result_menu = document.getElementById("result_menu");
            result_menu.style.display = 'flex'; 
            rmc.innerHTML = ''// resets everything so last result screen does not show in new game

            
            const win_msg = document.createElement('h1');
            win_msg.innerHTML = "<img src='X.png' style='height: 100px; vertical-align: middle;" +
                                    "margin-right: 50px;'>" +
                                    "It's a draw!!!" +
                                    "<img src='O.webp' style='height: 100px; vertical-align: middle;"+
                                    "margin-left: 50px;'>";
            
            const close_button = document.createElement('button');
            close_button.id = 'Result_close_button';
            close_button.innerHTML = "Close";
            close_button.style.width = "500px"
            close_button.style.height = "75px"
            close_button.onclick = hideResultMenu;
            close_button.style.display = 'flex';
            close_button.style.marginLeft = '25px'

            const view_game_table = document.createElement('button');
            view_game_table.id = 'Result_close_button';
            view_game_table.onclick = post_game_peek
            view_game_table.innerHTML = "View game board ";

            rmc.appendChild(win_msg);
            win_msg.appendChild(close_button);
            win_msg.appendChild(view_game_table)
            disable_game_table()
      }

      // runs connection as soon as script loads
      //createSocket();
      update_players();
</script>
</head>
<body>
      <table id="headtable" style="width: 100%;"> <!--creates head table -->
      <tr>
            <!--creates welcome banner and shows it to user-->
            <th colspan="3" style="font-size: 200%;"> <img src="X.png" alt="X" style="height: 40px; float: left;"> THE BEST TIC-TAC-TOE WEBSITE <img src="O.webp" alt="P" style="height: 40px; float: right;" ></th>
      </tr>
      <tr>
                  <!--title card that holds makers, help and logout -->
          <th colspan="3" style="font-size: 150%;">
                  <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style=" text-align: center;">
                              <p style=" margin-top:0; margin-bottom: 0; padding: 0;">Created by Ryan Retan and Bear Kennedy</p>
                        </div>
                  <div>
                  <a style="text-decoration: none;" href="#" onclick="open_help_menu()">Help |</a>
                  <a style="text-decoration: none;" href="#" onclick="logout(); return false;">Logout</a>
    </div>
</div>
</th>
      </tr>

      </table>

      <!--div that holds the login screen-->
      <div id="Log_in_screen" style="visibility: visible;">
           <h1 style="font-family: Arial, Helvetica, sans-serif">Please create an account:</h1>
            <!-- form that gets users username-->
            <form onsubmit="return false;"> <!-- doesn't reload the page and hides the menu -->
                  <label style="font-size: 25px; font-family: Arial, Helvetica, sans-serif" for="Screenname">Screen Name:</label><br>
                  <input type="text" id="Screenname"  placeholder="John"><br>
                  <!-- on submit, add the username to database-->
                  <input type="submit" value="Submit" onclick="addToDB()">
            </form> 
            <!-- send error here, if theres an error with adding the username to the database
             this gets changed -->
      <h1 id="error_msg" style="color: red; visibility: hidden;">error</h1>
      </div>

      <!-- the main table that holds everything, hidden until user logs in right-->
      <div id = "main_box" style="visibility: hidden;">
            <center>
            <div id = "idle">
                  idle users:
            </div>
            <!-- header for available games -->
            <div id = "avialable_games">
                 <p  id="avialable_games_headder"> Active games:
                  <button  id = "new_game_button" onclick = "newGameButton()">New Game</button></p>
                  <table id = "actives" style = "border: 2px solid black; border-collapse: collapse; text-align: center; width: 100%; ">
                  </table>
            </div>
            <!--div for selection X or O-->
            <div id="x_or_o" style="visibility: hidden;">
                  <div id = "x_or_o_content">
                        <h1>Pick a side to play</h1>
                        <img src="X.png" style="width: 100px; margin-right: 200px;">
                        <img src="O.webp" style="width: 100px;">
                        <div id ="button-container">
                        <!-- the buttons the user can pick from-->
                        <button id="pick_x" onclick = "document.getElementById('x_or_o').style.visibility = 'hidden'; makeGame('x')"> X </button>
                        <button id="pick_o" onclick = "document.getElementById('x_or_o').style.visibility = 'hidden'; makeGame('o')"> O </button>
                        </div>
                  </div>
            </div>

            <!-- where the tic-tac-toe game is played -->
            <div id = "game_window" style="">
                  <!-- header for game table that shows players and who's turn it is -->
                  <div id = "game_info"> 
                        <div class = "game_info_categories"> <h1 style="text-align: center" id = x_screen>X: Screenname</h1></div>
                        <div class = "game_info_categories"> <h1 style="text-align: center" id = "whoTurn">X's TURN</h1></div>
                        <div class = "game_info_categories"> <h1 style="text-align: center" id = o_screen>O: Screenname</h1></div>
                  </div>
            <div id = "game_contain_squares"> 
                  <!-- game squares with the buttons -->
                  <div class = "game_squares" name = "1"><button class="board_button" onclick="take_turn_setup(this,1)"></button></div>
                  <div class = "game_squares" name = "2"><button class="board_button" onclick="take_turn_setup(this,2)"></button></div>
                  <div class = "game_squares" name = "3"><button class="board_button" onclick="take_turn_setup(this,3)"></button></div>
                  <div class = "game_squares" name = "4"><button class="board_button" onclick="take_turn_setup(this,4)"></button></div>
                  <div class = "game_squares" name = "5"><button class="board_button" onclick="take_turn_setup(this,5)"></button></div>
                  <div class = "game_squares" name = "6"><button class="board_button" onclick="take_turn_setup(this,6)"></button></div>
                  <div class = "game_squares" name = "7"><button class="board_button" onclick="take_turn_setup(this,7)"></button></div>
                  <div class = "game_squares" name = "8"><button class="board_button" onclick="take_turn_setup(this,8)"></button></div>
                  <div class = "game_squares" name = "9"><button class="board_button" onclick="take_turn_setup(this,9)"></button></div>
            </div>
            <!-- leave game div-->
            <div width="100%" style= "">
                  <h1 onclick="toggle_game_div(),leave_game()" style="cursor: pointer;">LEAVE</h1>
      </div>
      </center>
      </div>
      </div>
     <!--<div>
      </div>--> 
      <!-- div for help menu-->
      <div id = "Help_menu" style="visibility: hidden;">
            <div class="Help_menu-content">
                  <!-- close button-->
                  <button onclick="close_help_menu()" class="close-button">X</button> 
                  <!-- help menu content -->
                  <h1 style="text-align: center;">Welcome to the best tic-tac-toe website out There</h1>
                  <h3>Created by Ryan and Bear:</h3>
                  <p> Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat.
                        In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar
                        vivamus fringilla lacus nec metus bibendum egestas. 
                        Iaculis massa nisl malesuada lacinia integer nunc posuere.
                        Ut hendrerit semper vel class aptent taciti sociosqu. 
                        Ad litora torquent per conubia nostra inceptos himenaeos. </p>
                  <p>Lorem ipsum dolor sit amet consectetur adipiscing elit.
                        Quisque faucibus ex sapien vitae pellentesque sem placerat. 
                        In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor.
                        Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. 
                        Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos</p>
                  <p>Lorem ipsum dolor sit amet consectetur adipiscing elit. 
                        Quisque faucibus ex sapien vitae pellentesque sem placerat. 
                        In id cursus mi pretium tellus duis convallis. 
                        Tempus leo eu aenean sed diam urna tempor. 
                        Pulvinar vivamus fringilla lacus nec metus bibendum egestas. 
                        Iaculis massa nisl malesuada lacinia integer nunc posuere. 
                        Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per 
                        conubia nostra inceptos himenaeos.Lorem ipsum dolor sit amet consectetur 
                        adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat.
                  </p>
                        
                  </div>
            </div>
      </div>
      <!-- div that holds the result menu that we add stuff too later on -->
      <div id="result_menu" style="display: none ">
            <div id="result_menu-content">  
      </div>
</body>
</html>